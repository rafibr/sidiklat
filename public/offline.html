<!DOCTYPE html>
<html lang="id">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>SIDIKLAT - Offline Mode</title>
	<style>
		body {
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
			margin: 0;
			padding: 20px;
			background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
			color: white;
			min-height: 100vh;
			display: flex;
			align-items: center;
			justify-content: center;
		}

		.offline-container {
			text-align: center;
			max-width: 500px;
			background: rgba(255, 255, 255, 0.1);
			padding: 40px;
			border-radius: 20px;
			backdrop-filter: blur(10px);
			box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
		}

		.offline-icon {
			font-size: 4rem;
			margin-bottom: 1rem;
			opacity: 0.8;
			animation: pulse 2s infinite;
		}

		.offline-title {
			font-size: 2rem;
			font-weight: bold;
			margin-bottom: 1rem;
		}

		.offline-message {
			font-size: 1.1rem;
			margin-bottom: 2rem;
			opacity: 0.9;
			line-height: 1.6;
		}

		.retry-btn {
			background: rgba(255, 255, 255, 0.2);
			border: 2px solid rgba(255, 255, 255, 0.3);
			color: white;
			padding: 12px 24px;
			border-radius: 8px;
			text-decoration: none;
			display: inline-block;
			transition: all 0.3s ease;
			margin: 10px;
		}

		.retry-btn:hover {
			background: rgba(255, 255, 255, 0.3);
			transform: translateY(-2px);
		}

		.features {
			margin-top: 3rem;
			text-align: left;
			background: rgba(255, 255, 255, 0.1);
			padding: 20px;
			border-radius: 15px;
		}

		.features h3 {
			font-size: 1.3rem;
			margin-bottom: 1rem;
			color: #fbbf24;
		}

		.features ul {
			list-style: none;
			padding: 0;
		}

		.features li {
			margin-bottom: 0.8rem;
			opacity: 0.9;
			display: flex;
			align-items: center;
		}

		.features li:before {
			content: "‚úÖ ";
			color: #10b981;
			font-weight: bold;
			margin-right: 10px;
		}

		.connection-info {
			margin-top: 2rem;
			padding: 15px;
			background: rgba(251, 191, 36, 0.2);
			border-radius: 10px;
			border-left: 4px solid #fbbf24;
		}

		.connection-info h4 {
			color: #fbbf24;
			margin-bottom: 0.5rem;
		}

		@keyframes pulse {

			0%,
			100% {
				opacity: 0.8;
			}

			50% {
				opacity: 0.4;
			}
		}

		.status-indicator {
			display: inline-block;
			width: 12px;
			height: 12px;
			background: #ef4444;
			border-radius: 50%;
			margin-right: 8px;
			animation: blink 1s infinite;
		}

		@keyframes blink {

			0%,
			50% {
				opacity: 1;
			}

			51%,
			100% {
				opacity: 0.3;
			}
		}
	</style>
</head>

<body>
	<div class="offline-container">
		<div class="status-indicator"></div>
		<div class="offline-icon">üì±</div>
		<h1 class="offline-title">Mode Offline Aktif</h1>
		<p class="offline-message">
			Koneksi internet Anda terputus. Jangan khawatir! SIDIKLAT telah menyimpan data penting di perangkat Anda
			sehingga Anda tetap dapat mengakses fitur-fitur utama.
		</p>

		<div>
			<a href="/" class="retry-btn">üîÑ Coba Lagi</a>
			<a href="javascript:window.history.back()" class="retry-btn">‚¨ÖÔ∏è Kembali</a>
		</div>

		<div class="features">
			<h3>üöÄ Fitur yang Tersedia Offline:</h3>
			<ul>
				<li>Melihat dashboard dengan data terakhir</li>
				<li>Melihat progress pegawai yang telah dimuat</li>
				<li>Melihat daftar pelatihan yang tersimpan</li>
				<li>Navigasi antar halaman yang telah dikunjungi</li>
				<li>Menggunakan fitur pencarian pada data lokal</li>
				<li>Melihat detail pelatihan yang telah dibuka</li>
			</ul>
		</div>

		<div class="connection-info">
			<h4>üîÑ Koneksi Akan Dipulihkan Otomatis</h4>
			<p>Sistem akan terus memantau koneksi dan secara otomatis memuat ulang halaman ketika koneksi internet
				tersedia kembali.</p>
		</div>
	</div>

	<script>
		// Auto-retry connection every 5 seconds
		let retryCount = 0;
		const maxRetries = 60; // 5 minutes

		function checkConnection() {
			if (navigator.onLine && retryCount < maxRetries) {
				// Try to fetch a small resource to verify connection
				fetch('/favicon.ico', {
					method: 'HEAD',
					cache: 'no-cache'
				})
					.then(() => {
						window.location.reload();
					})
					.catch(() => {
						retryCount++;
						setTimeout(checkConnection, 5000);
					});
			} else if (retryCount >= maxRetries) {
				// Show manual retry option
				document.querySelector('.offline-message').innerHTML +=
					'<br><small style="color: #fbbf24;">Coba refresh halaman secara manual jika diperlukan.</small>';
			} else {
				setTimeout(checkConnection, 5000);
			}
		}

		// Start checking connection
		setTimeout(checkConnection, 3000);

		// Listen for online event
		window.addEventListener('online', () => {
			window.location.reload();
		});

		// Add some interactive feedback
		document.querySelectorAll('.retry-btn').forEach(btn => {
			btn.addEventListener('click', function () {
				this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Menghubungkan...';
				this.style.pointerEvents = 'none';
			});
		});

		// Show connection attempts
		let connectionAttempts = 0;
		const statusIndicator = document.querySelector('.status-indicator');

		setInterval(() => {
			if (!navigator.onLine) {
				connectionAttempts++;
				if (connectionAttempts % 2 === 0) {
					statusIndicator.style.background = '#fbbf24'; // Yellow when attempting
				} else {
					statusIndicator.style.background = '#ef4444'; // Red when waiting
				}
			}
		}, 2500);
	</script>
</body>

</html>